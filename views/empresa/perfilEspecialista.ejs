<!doctype html>
<html lang="en">
  <%- include('partials/head') %> 
  <body class="vertical  light  ">
    <div class="wrapper">
      <%- include('partials/navbar') %> 
     <%- include('partials/sidebar') %> 
      <main role="main" class="main-content">
        <div class="container-fluid">
          <div class="row justify-content-center">
            <div class="col-12">
              <h2 class="h3 mb-4 page-title">Especialista</h2>
              <div class="row mt-5 align-items-center">
                <div class="col-md-3 text-center mb-5">
                  <div class="avatar avatar-xl">
                    <div class="dropdown">
                      
                      <button class="btn btn-sm dropdown-toggle more-vertical" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img src="/uploads/<%= especialista.img %> " alt=".." class="avatar-img rounded-circle">
                      </button>
                      <div class="dropdown-menu dropdown-menu-right">
                       
                        <a class="dropdown-item fe fe-camera" href="#" >+ Foto</a>
                        
                      </div>
                    </div>
                   
                  </div>
                </div>
                <div class="col">
                  <div class="row align-items-center">
                    <div class="col-md-7">
                      <h4 class="mb-1"><%= especialista.name%> </h4>
                      <br>
                      <p class="small mb-0 text-muted"><%= especialista.email%> </p>
                      <p class="small mb-0 text-muted"><%= especialista.endereco%> </p>
                      <p class="small mb-0 text-muted">(+244) <%= especialista.tel%> </p>
                      <br>
                    </div>

                  </div>
                  <div class="row mb-4">
                    <div class="col-md-7">
                      <button class="btn btn-primary"> Editar Perfil</button>
                      <% if(especialista.estado==0){%>
                        <button class="btn btn-success btn-round fe fe-toggle-right"  onclick="ativar( `<%= especialista.id %>`)"> </button>
                                <%  } else{%>
                        <button class="btn btn-danger btn-round fe fe-toggle-left "  onclick="desativar( `<%= especialista.id %>`)"></button>
                                   <%  }%> 
                    </div>
                    <!--
                    <div class="col">
                      <p class="small mb-0 text-muted"><%= especialista.email%> </p>
                      <p class="small mb-0 text-muted"><%= especialista.endereco%> </p>
                      <p class="small mb-0 text-muted">(+244) <%= especialista.tel%> </p>
                    </div>
                    -->
                  </div>
                </div>
              </div>
              <div class="row my-4">
                <div class="col-md-4">
                  <div class="card mb-4 shadow">
                    <div class="card-body my-n3">
                      <div class="row align-items-center">
                        <div class="col-3 text-center">
                          <span class="circle circle-lg bg-light">
                            <i class="fe fe-user fe-24 text-primary"></i>
                          </span>
                        </div> <!-- .col -->
                        <div class="col">
                          <a href="#">
                            <h3 class="h5 mt-4 mb-1">Dados Pessoal</h3>
                          </a>
                          <p class="text-muted"><%= especialista.user_name %> .</p><br>
                        </div> <!-- .col -->
                      </div> <!-- .row -->
                    </div> <!-- .card-body -->
                    <div class="card-footer">
                      <a href="" class="d-flex justify-content-between text-muted"><span>Account Settings</span><i class="fe fe-chevron-right"></i></a>
                    </div> <!-- .card-footer -->
                  </div> <!-- .card -->
                </div> <!-- .col-md-->
                <div class="col-md-4">
                  <div class="card mb-4 shadow">
                    <div class="card-body my-n3">
                      <div class="row align-items-center">
                        <div class="col-3 text-center">
                          <span class="circle circle-lg bg-light">
                            <i class="fe fe-shield fe-24 text-primary"></i>
                          </span>
                        </div> <!-- .col -->
                        <div class="col">
                          <a href="#">
                            <h3 class="h5 mt-4 mb-1">Local</h3>
                          </a>
                          <p class="text-muted"> <%= local.length %> <br>
                            Local de Atuação </p>
                          
                        </div> <!-- .col -->
                      </div> <!-- .row -->
                    </div> <!-- .card-body -->
                    <div class="card-footer">
                      <a href="" class="d-flex justify-content-between text-muted"><span>Security Settings</span><i class="fe fe-chevron-right"></i></a>
                    </div> <!-- .card-footer -->
                  </div> <!-- .card -->
                </div> <!-- .col-md-->
                <div class="col-md-4">
                  <div class="card mb-4 shadow">
                    <div class="card-body my-n3">
                      <div class="row align-items-center">
                        <div class="col-3 text-center">
                          <span class="circle circle-lg bg-light">
                            <i class="fe fe-bell fe-24 text-primary"></i>
                          </span>
                        </div> <!-- .col -->
                        <div class="col">
                          <a href="#">
                            <h3 class="h5 mt-4 mb-1">Contactos</h3>
                          </a>
                          <p class="small mb-0 text-muted"><%= especialista.email%> <br> 
                            (+244) <%= especialista.tel%> </p>
                            
                        </div> <!-- .col -->
                      </div> <!-- .row -->
                    </div> <!-- .card-body -->
                    <div class="card-footer">
                      <a href="" class="d-flex justify-content-between text-muted"><span>Notification Settings</span><i class="fe fe-chevron-right"></i></a>
                    </div> <!-- .card-footer -->
                  </div> <!-- .card -->
                </div> <!-- .col-md-->
              </div> <!-- .row-->
              <div class="modal fade modal-full" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
                <button aria-label="" type="button" class="close px-2" data-dismiss="modal" aria-hidden="true">
                  <span aria-hidden="true">×</span>
                </button>
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-body text-center">
                      <p>Relatorio de Ocorrencia Resolvidos pelo <%= especialista.user_name %>. </p>
                      <form class="form-inline justify-content-center" action="/relatorioEspecialista" method="post">
                        <div class="form-group col-4">
                          <label for="inputCity">De</label>
                          <input type="date" class="form-control form-control-lg mr-sm-2 bg-transparent" name="inicio" id="inputCity">
                        </div>
                        <div class="form-group col-4">
                          <label for="inputCity">Até</label>
                          <input type="date" class="form-control form-control-lg mr-sm-2 bg-transparent" name="fim" id="inputCity">
                        </div>
                        <div class="form-group col-4">
                          <input type="hidden" class="form-control form-control-lg mr-sm-2 bg-transparent" name="id" value="<%= especialista.id %> ">
                          <label for="inputCity">.</label>
                          <button class="btn btn-primary btn-lg mb-2 my-2 my-sm-0" type="submit">Pesquisar</button>
                        </div>
                        
                      </form>
                     
                    </div>
                  </div>
                </div>
              </div>
              <h6 class="mb-3">Local Designado</h6> 
              <button type="button" class="btn mb-2 btn-outline-secondary" data-toggle="modal" data-target="#varyModal" data-whatever="@mdo">+ Local</button>
              <button type="button" class="btn mb-2 btn-secondary" data-toggle="modal" data-target=".modal-full">Relatorio</button>
                         
              <div class="modal fade" id="varyModal" tabindex="-1" role="dialog" aria-labelledby="varyModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title" id="varyModalLabel">Novo Local</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                              <form method="post" action="/Local">
                                <div class="form-group">
                                  <label for="recipient-name" class="col-form-label">Provincia:</label>
                                  <select required class="form-control " name="provincia" id="slctprovincia" onchange="populate(this.id,'slctmunicipio')" autofocus>
								  
                                    <option disabled="disabled" selected="selected"> Escolha a província</option>
                                    <option value="luanda">Luanda</option>
                                       <option value="benguela">Benguela</option>
                                       <option value="bengo">Bengo</option>
                                       <option value="bié">Bié</option>
                                       <option value="cabinda">Cabinda</option>
                                       <option value="cuando-cubango">Cuando-Cubango</option>
                                       <option value="cuanza norte">Cuanza Norte</option>
                                       <option value="cuanza sul">Cuanza Sul</option>
                                       <option value="cunene">Cunene</option>
                                       <option value="huambo">Huambo</option>
                                       <option value="huíla">Huíla</option>
                                       <option value="lunda norte">Lunda Norte</option>
                                       <option value="lunda sul">Lunda Sul</option>
                                       <option value="malange">Malange</option>
                                       <option value="moxico">Moxico</option>
                                       <option value="namibe">Namibe</option>
                                       <option value="uíge">Uíge</option>
                                       <option value="zaire">Zaire</option>
                                  
                                  </select>
                                </div>
                                <div class="form-group">
                                  <label for="message-text" class="col-form-label">Municipio:</label>
                                  <select autofocus required name="municipio" id="slctmunicipio" class="form-control"> <option disabled="disabled" selected="selected"> Escolha o municipio</option></select> 
                        
                                </div>
                                <input type="hidden" name="id" value="<%= especialista.id %> ">
                              
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn mb-2 btn-secondary" data-dismiss="modal">Close</button>
                              <button type="submit" class="btn mb-2 btn-primary">Adicionar Local</button>
                            </div>
                          </form>
                          </div>
                        </div>
                      </div>
              <table class="table table-borderless table-striped">
                <thead>
                  <tr role="row">
                    <th>ID</th>
                    <th>Provincia</th>
                    <th>Municipio</th>
                    <th>Estado</th>
                    
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <% local.map(local=>{%>
                    <tr>
                    <th scope="col"><%= local.id%></th>
                    
                    <td><%= local.provincia%></td>
                    <td><%= local.municipio%></td>
                    <td><span class="dot dot-lg bg-warning mr-2"></span>Due</td>
                    <td>
                      <div class="dropdown">
                        <button class="btn btn-sm dropdown-toggle more-vertical" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          <span class="text-muted sr-only">Action</span>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right">
                         
                          <a class="dropdown-item fe fe-trash" href="#" onclick="confirmar( `<%= local.id %>`)"> Remove</a>
                          
                        </div>
                      </div>
                    </td>
                  </tr>
                  <%  }) %> 
                  
                 
                </tbody>
              </table>
            </div> <!-- /.col-12 -->
          </div> <!-- .row -->
        </div> <!-- .container-fluid -->
       <%- include('partials/modal') %> 
      </main> <!-- main -->
    </div> <!-- .wrapper -->
    <script src="/Dash/js/jquery.min.js"></script>
    <script src="/Dash/js/popper.min.js"></script>
    <script src="/Dash/js/moment.min.js"></script>
    <script src="/Dash/js/bootstrap.min.js"></script>
    <script src="/Dash/js/simplebar.min.js"></script>
    <script src='/Dash/js/daterangepicker.js'></script>
    <script src='/Dash/js/jquery.stickOnScroll.js'></script>
    <script src="/Dash/js/tinycolor-min.js"></script>
    <script src="/Dash/js/config.js"></script>
    <script src="/Dash/js/apps.js"></script>
    <script src="/script/ApiProvincia-municipio.js"></script>
    <script src="/sweetalert/sweetalert2.all.min.js"></script>
    <% if(errado.length >0) {%>
        <script>
    var Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 3000,
  timerProgressBar: true,
  didOpen: (toast) => {
    toast.addEventListener('mouseenter', Swal.stopTimer)
    toast.addEventListener('mouseleave', Swal.resumeTimer)
  }
})
Toast.fire({
  icon: 'error',
  title: '<%=errado %>'
})
        </script>
       
        <% }else if(certo.length >0) {%>
          <script>
    
const Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 3000,
  timerProgressBar: true,
  didOpen: (toast) => {
    toast.addEventListener('mouseenter', Swal.stopTimer)
    toast.addEventListener('mouseleave', Swal.resumeTimer)
  }
})

Toast.fire({
  icon: 'success',
  title: `<%= certo %>`
})
            
          </script>
          <% }%>
    <script>
      $('#dataTable-1').DataTable(
      {
        autoWidth: true,
        "lengthMenu": [
          [5, 10, 20, -1],
          [5, 10, 20, "All"]
        ]
      });
    </script>
      <script>
        function confirmar(id){
          
      Swal.fire({
        title: 'Queres Deletar ?',
      icon:'warning',
        showCancelButton: true,
        confirmButtonColor:'#3085d6',
        cancelButtonColor:'#d33',
        confirmButtonText: 'Confirmar',
      
      }).then((result) => {
        /* Read more about isConfirmed, isDenied below   */
        if (result.isConfirmed) {
      
         window.location = '/deletarlocal/'+id;
        } else if (result.isDenied) {
          Swal.fire('Erro ao eliminar', '', 'info')
        }
      })
        }

        function ativar(id){
    
    Swal.fire({
      title: 'Queres ativar esta conta?',
    icon:'warning',
      showCancelButton: true,
      confirmButtonColor:'#3085d6',
      cancelButtonColor:'#d33',
      confirmButtonText: 'Confirmar',
    
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below   */
      if (result.isConfirmed) {
    
       window.location = '/Ativar/'+id;
      } else if (result.isDenied) {
        Swal.fire('Erro ao eliminar', '', 'info')
      }
    })
      }
  function desativar(id){
    
    Swal.fire({
      title: 'Queres desativar esta conta ?',
    icon:'warning',
      showCancelButton: true,
      confirmButtonColor:'#3085d6',
      cancelButtonColor:'#d33',
      confirmButtonText: 'Confirmar',
    
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below   */
      if (result.isConfirmed) {
    
       window.location = '/Desativar/'+id;
      } else if (result.isDenied) {
        Swal.fire('Erro ao eliminar', '', 'info')
      }
    })
      }
   
        </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-56159088-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag()
      {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'UA-56159088-1');
    </script>
  </body>
</html>